import{W as g,r as y,j as e,a as N}from"./app-CU81j7nS.js";import{P as _}from"./PrimaryButton-B91Wo0_j.js";import{n}from"./index-CRzonMBn.js";import{d as b}from"./index-W5QgHgs8.js";function C({kyc:c=[],className:u=""}){const{data:a,setData:x,errors:l,post:m,processing:h,delete:S}=g({identity_verification:null,address_verification:null}),[d,D]=y.useState(c.reduce((t,r)=>({...t,[r.document_type]:r.status}),{})),f=t=>{const{name:r,files:s}=t.target;x(r,s[0])},j=t=>{t.preventDefault();const r=new FormData;r.append("identity_verification",a.identity_verification),r.append("address_verification",a.address_verification),m(route("profile.kyc.submit"),{data:r,preserveScroll:!0,onSuccess:()=>{n.success("Documents soumis avec succès.")},onError:()=>{n.error("Une erreur est survenue.")}})},p=t=>{console.log(t),b.Inertia.delete(route("profile.kyc.delete",{user_id:t}),{preserveScroll:!0,onSuccess:()=>{n.success("Document supprimé avec succès.")},onError:()=>{n.error("Erreur lors de la suppression.")}})},o=(t,r)=>{const s=d[t],i=c.find(v=>v.document_type===t);return s==="verified"?e.jsxs("tr",{children:[e.jsx("td",{children:r}),e.jsx("td",{children:e.jsx("span",{className:"px-2 py-1 text-xs text-green-700 bg-green-100 rounded-full",children:"Validé"})}),e.jsx("td",{children:e.jsx("a",{href:`/storage/${i.document_path}`,target:"_blank",className:"text-blue-600 hover:underline",children:"Voir le fichier"})})]},t):s==="pending"?e.jsxs("tr",{children:[e.jsx("td",{children:r}),e.jsx("td",{children:e.jsx("span",{className:"px-2 py-1 text-xs text-yellow-700 bg-yellow-100 rounded-full",children:"En attente"})}),e.jsx("td",{children:e.jsx("a",{href:i.document_path,target:"_blank",className:"text-blue-600 hover:underline",children:"Voir le fichier"})})]},t):s==="rejected"?e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{children:r}),e.jsx("td",{children:e.jsx("span",{className:"px-2 py-1 text-xs text-red-700 bg-red-100 rounded-full",children:"Rejeté"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:i.document_path,target:"_blank",className:"text-blue-600 hover:underline",children:"Voir le fichier"}),e.jsx(N,{className:"text-red-600 hover:underline",onClick:()=>p(i.user_id),children:"Supprimer"})]})})]},t)}):e.jsxs("tr",{children:[e.jsx("td",{children:r}),e.jsx("td",{children:e.jsx("span",{className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded-full",children:"Non soumis"})}),e.jsx("td",{children:e.jsx("input",{type:"file",name:t,onChange:f,className:"mt-1 block w-full"})})]},t)};return e.jsxs("section",{className:u,children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Vérification KYC"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Soumettez vos documents pour la vérification de votre compte."})]}),e.jsxs("form",{onSubmit:j,className:"mt-6 space-y-6",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Statut"}),e.jsx("th",{children:"Action"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[o("identity_verification","Vérification d'identité"),o("address_verification","Vérification d'adresse")]})]}),(!d.identity_verification||!d.address_verification)&&e.jsx("div",{className:"flex items-center gap-4 mt-4",children:e.jsx(_,{disabled:h,children:"Soumettre les documents"})}),l.documents&&e.jsx("div",{className:"mt-2 text-red-600 text-sm",children:l.documents})]})]})}export{C as default};
