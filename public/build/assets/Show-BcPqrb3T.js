import{W as S,r as f,q as F,j as e,Y as A}from"./app-CU81j7nS.js";import{A as $,m as k}from"./AuthenticatedLayout-dRBKfQCh.js";import{n as a}from"./index-CRzonMBn.js";import{P as c}from"./PrimaryButton-B91Wo0_j.js";import"./index-W5QgHgs8.js";import"./ApplicationLogo-CKQckDiy.js";import"./transition-CyRQxhFf.js";import"./SecondaryButton-BoGYldyN.js";function R({user:r,formations:N,bots:y,activeSubscriptions:d,activeFormationSubscriptions:B,kyc:m}){var j,g,b;const{post:n,processing:D}=S(),v=k.name,[l,t]=f.useState(!1),{flash:o}=F().props;f.useEffect(()=>{o.success&&a.success(o.success),o.error&&a.error(o.error)},[o]);const x=(s,i)=>{t(!0),n(route("kyc.validate",{documentId:s,status:i}),{onSuccess:()=>{a.success(`Le statut KYC a été ${i==="verified"?"vérifié":"rejeté"} avec succès !`)},onError:()=>{a.error("Erreur lors de la souscription.")},onFinish:()=>t(!1)})},w=s=>{if(!r||!r.id){a.error("Utilisateur non valide.");return}window.confirm(`Êtes-vous sûr de vouloir activer cette formation pour ${r.username} ?`)&&(t(!0),n(route("user.subscribe.formation",{user_id:r.id,formation_id:s}),{onSuccess:()=>{a.success("Souscription à la formation réussie.")},onError:()=>{a.error("Erreur lors de la souscription.")},onFinish:()=>t(!1)}))},_=(s,i)=>{window.confirm(`Êtes-vous sûr de vouloir souscrire à ce bot pour ${r.username} ?`)&&(t(!0),n(route("user.subscribe.bot",{user:r.id,bot_id:s,duration_days:i}),{onSuccess:()=>{a.success("Souscription au bot réussie.")},onError:()=>{a.error("Erreur lors de la souscription.")},onFinish:()=>t(!1)}))},E=s=>{window.confirm(`Êtes-vous sûr de vouloir annuler la souscription de ${r.username} à cette formation ?`)&&(t(!0),n(route("user.unsubscribe.formation",{user:r.id,formationId:s}),{onSuccess:()=>{a.success("Souscription à la formation annulée.")},onError:()=>{a.error("Erreur lors de l'annulation de la souscription.")},onFinish:()=>t(!1)}))},C=s=>{window.confirm(`Êtes-vous sûr de vouloir annuler la souscription de ${r.username} à ce bot ?`)&&(t(!0),n(route("user.unsubscribe.bot",{user:r.id,botId:s}),{onSuccess:()=>{a.success("Souscription au bot annulée.")},onError:()=>{a.error("Erreur lors de l'annulation de la souscription.")},onFinish:()=>t(!1)}))},u=s=>{navigator.clipboard.writeText(s).then(()=>{a.success("Texte copié avec succès !")}).catch(()=>{a.error("Échec de la copie")})},h=s=>r.formation_subscriptions.some(i=>i.formation_id===s),p=s=>d.some(i=>i.bot_id===s&&new Date(i.expiration_date)>new Date);return e.jsxs($,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800",children:`${r.first_name} ${r.last_name}`}),children:[e.jsx(A,{title:`${r.first_name} ${r.last_name}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"Informations utilisateur"}),e.jsxs("p",{className:"text-gray-600",children:["Email: ",r.email]}),e.jsxs("p",{className:"text-gray-600",children:["Username:"," ",e.jsx("span",{onClick:()=>u(r.username),className:"text-blue-500 cursor-pointer hover:underline",children:r.username})]}),e.jsxs("p",{className:"text-gray-600",children:["Pays: ",((j=r.country)==null?void 0:j.name)||"Non spécifié"]}),e.jsxs("p",{className:"text-gray-600",children:["Numéro de téléphone:"," ",r.phone_number||"Non spécifié"]}),e.jsx("p",{className:"text-gray-600",children:r.sponsor?`Sponsorisé par : ${r.sponsor.username}`:"Aucun sponsor"}),e.jsxs("p",{className:"text-gray-600",children:["Balance:"," ",e.jsxs("strong",{children:[r.balance," ",v]})]}),e.jsxs("p",{className:"text-gray-600",children:["Mot de passe:"," ",e.jsx("span",{onClick:()=>u(r.visible_password),className:"text-blue-500 cursor-pointer hover:underline",children:r.visible_password})]}),e.jsx("hr",{className:"my-6 border-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"Distinctions"}),((g=r.distinctions)==null?void 0:g.length)>0?e.jsx("ul",{children:r.distinctions.map(s=>e.jsxs("li",{className:"text-gray-600",children:[s.name," - Acquis le:"," ",s.pivot.date_acquired]},s.id))}):e.jsx("p",{className:"text-gray-600",children:"Aucune distinction"}),e.jsx("hr",{className:"my-6 border-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"Abonnements aux Bots Actifs"}),d.length>0?e.jsx("ul",{className:"space-y-4",children:d.map(s=>{var i;return e.jsx("li",{className:"p-4 border rounded-lg shadow-sm bg-gray-50",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:((i=s.bot)==null?void 0:i.name)||"Bot inconnu"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Expiration :"," ",e.jsx("span",{className:"font-medium",children:new Date(s.expiration_date).toLocaleDateString()})]})]}),e.jsx("button",{onClick:()=>{C(s.bot_id)},className:"mt-4 md:mt-0 text-red-500 hover:underline",children:"Annuler"})]})},s.id)})}):e.jsx("p",{className:"text-gray-600",children:"Aucun abonnement actif"}),e.jsx("hr",{className:"my-6 border-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"Formations souscrites"}),((b=r.formation_subscriptions)==null?void 0:b.length)>0?e.jsx("ul",{className:"space-y-4",children:r.formation_subscriptions.map(s=>{var i;return e.jsx("li",{className:"p-4 border rounded-lg shadow-sm bg-gray-50",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between",children:[e.jsx("div",{children:e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:((i=s.formation)==null?void 0:i.name)||"Formation inconnue"})}),e.jsx("button",{onClick:()=>{E(s.formation_id)},className:"mt-4 md:mt-0 text-red-500 hover:underline",children:"Annuler"})]})},s.id)})}):e.jsx("p",{className:"text-gray-600",children:"Aucune formation souscrite"}),e.jsx("hr",{className:"my-6 border-gray-300"}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Formations disponibles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(s=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:s.name}),e.jsx("p",{className:"text-gray-600",children:s.details}),e.jsx(c,{onClick:()=>w(s.id),disabled:h(s.id)||l,children:h(s.id)?"Déjà activé":"Activer"})]},s.id))})]}),e.jsx("hr",{className:"my-6 border-gray-300"}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Bots disponibles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(s=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:s.name}),e.jsx("p",{className:"text-gray-600",children:s.details}),e.jsx(c,{onClick:()=>_(s.id,s.profit_duration_days),disabled:p(s.id)||l,children:p(s.id)?"Déjà souscrit":"Souscrire"})]},s.id))})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"Vérification KYC"}),e.jsx("div",{className:"mt-4 border p-4 rounded-lg bg-gray-50",children:m.length===0?e.jsx("p",{className:"text-gray-600",children:"Aucun document KYC soumis."}):m.map(s=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-gray-600",children:[s.document_type==="identity_verification"?"Vérification d'identité":"Vérification d'adresse"," ",":"," ",e.jsx("span",{className:"font-medium",children:s.status==="pending"?"En attente":s.status==="verified"?"Validé":"Rejeté"})]}),e.jsxs("p",{className:"text-gray-600",children:["Document KYC:"," ",e.jsx("a",{href:`/storage/${s.document_path}`,target:"_blank",className:"text-blue-500 hover:underline",children:"Voir le document"})]})]}),s.status==="pending"&&e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(c,{onClick:()=>x(s.id,"verified"),disabled:l,children:"Valider"}),e.jsx(c,{onClick:()=>x(s.id,"rejected"),disabled:l,className:"bg-red-500 hover:bg-red-600 text-white",children:"Rejeter"})]})]},s.id))}),e.jsx("hr",{className:"my-6 border-gray-300"})]})]})})})})]})}export{R as default};
