import{r as u,W as F,j as e,Y as E,a as G,b as L}from"./app-CU81j7nS.js";import{T as m,I as l}from"./TextInput-CmnHJseN.js";import{I as i}from"./InputLabel-B1UNEY7t.js";import{P as R}from"./PrimaryButton-B91Wo0_j.js";import{G as T}from"./GuestLayout-vq8oWw2g.js";import{n as f}from"./index-CRzonMBn.js";import"./ApplicationLogo-CKQckDiy.js";function J(){const j=new URLSearchParams(window.location.search).get("sponsor_id")||"",[h,v]=u.useState({}),[d,w]=u.useState(!1),[N,C]=u.useState(!0),[y,_]=u.useState(""),[x,b]=u.useState(!1),{data:t,setData:n,post:k,processing:g,errors:o,reset:P}=F({first_name:"",last_name:"",username:"",email:"",password:"",password_confirmation:"",sponsor_id:j,country_id:"",phone:""});u.useEffect(()=>{(async()=>{try{const r=(await L.get("/countries")).data.reduce((c,p)=>(c[p.continent]||(c[p.continent]=[]),c[p.continent].push(p),c),{});v(r)}catch(a){console.error("Erreur lors de la récupération des pays:",a)}finally{C(!1)}})()},[]);const S=s=>{const a=s.target.value,r=Object.values(h).flat().find(c=>c.id===parseInt(a));r&&_(r.phone_code),n("country_id",a)},I=s=>{if(s.preventDefault(),!x){f.error("Veuillez lire et accepter les CGU avant de vous inscrire.");return}k(route("register"),{onSuccess:a=>{var r;(r=a.props.flash)!=null&&r.success&&(f.success(a.props.flash.success),P(),setTimeout(()=>{f("Redirection en cours..."),setTimeout(()=>{window.location.href=route("login")},1500)},1e3))},onError:a=>{for(const r in a)f.error(a[r])}})},q=()=>{w(!d)};return N?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"spinner-border animate-spin inline-block w-12 h-12 border-4 rounded-full",style:{borderColor:"#88ae75 transparent #88ae75 transparent"}})}):e.jsxs(T,{children:[e.jsx(E,{title:"Inscription"}),e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"first_name",value:"Prenom"}),e.jsx(m,{id:"first_name",name:"first_name",value:t.first_name,className:"mt-1 block w-full focus:ring focus:ring-[#88ae75]",autoComplete:"first_name",isFocused:!0,onChange:s=>n("first_name",s.target.value),required:!0}),e.jsx(l,{message:o.first_name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"last_name",value:"Nom"}),e.jsx(m,{id:"last_name",name:"last_name",value:t.last_name,className:"mt-1 block w-full focus:ring focus:ring-[#88ae75]",autoComplete:"last_name",onChange:s=>n("last_name",s.target.value),required:!0}),e.jsx(l,{message:o.last_name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"username",value:"Nom d'utilisateur"}),e.jsx(m,{id:"username",name:"username",value:t.username,className:"mt-1 block w-full focus:ring focus:ring-[#88ae75]",autoComplete:"username",onChange:s=>n("username",s.target.value),required:!0}),e.jsx(l,{message:o.username,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"email",value:"E-mail"}),e.jsx(m,{id:"email",type:"email",name:"email",value:t.email,className:"mt-1 block w-full focus:ring focus:ring-[#88ae75]",autoComplete:"email",onChange:s=>n("email",s.target.value),required:!0}),e.jsx(l,{message:o.email,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"country",value:"Pays"}),e.jsxs("select",{id:"country",name:"country",value:t.country,className:"mt-1 block w-full focus:ring focus:ring-[#88ae75] hover:border-[#88ae75] rounded-md",onChange:S,required:!0,children:[e.jsx("option",{value:"",children:"Sélectionnez un pays"}),Object.keys(h).map(s=>e.jsx("optgroup",{label:s,children:h[s].map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))},s))]}),e.jsx(l,{message:o.country,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"phone",value:"Numéro de téléphone"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"bg-gray-200 text-gray-700 rounded-l-md px-4 py-2",children:y||"N/A"}),e.jsx(m,{id:"phone",name:"phone",value:t.phone,className:"mt-1 block w-full rounded-r-md focus:ring focus:ring-[#88ae75]",autoComplete:"phone",onChange:s=>n("phone",s.target.value),required:!0})]}),e.jsx(l,{message:o.phone,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"password",value:"Mot de passe"}),e.jsx(m,{id:"password",type:d?"text":"password",name:"password",value:t.password,className:"mt-1 block w-full focus:ring focus:ring-[#88ae75]",autoComplete:"new-password",onChange:s=>n("password",s.target.value),required:!0}),e.jsx(l,{message:o.password,className:"mt-2"}),e.jsx("a",{href:"#",onClick:q,className:"text-sm text-blue-600 hover:underline mt-1",children:d?"Masquer le mot de passe":"Afficher le mot de passe"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"password_confirmation",value:"Confirmer le mot de passe"}),e.jsx(m,{id:"password_confirmation",type:d?"text":"password",name:"password_confirmation",value:t.password_confirmation,className:"mt-1 block w-full focus:ring focus:ring-[#88ae75]",autoComplete:"new-password",onChange:s=>n("password_confirmation",s.target.value),required:!0}),e.jsx(l,{message:o.password_confirmation,className:"mt-2"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:s=>b(s.target.checked),className:"focus:ring focus:ring-[#88ae75] text-[#88ae75]"}),e.jsxs("span",{className:"ml-2 text-gray-700",children:["J'ai lu et j'accepte les"," ",e.jsx("a",{href:"https://imarket-consulting.com/conditions-generales-dutilisation/",className:"text-blue-600 hover:underline",children:"conditions générales d'utilisation"}),"."]})]})}),e.jsxs("div",{className:"flex items-center justify-end mt-4",children:[e.jsx(G,{href:route("login"),className:"underline text-sm text-gray-600 hover:text-gray-900",children:"Déjà enregistré ?"}),e.jsx(R,{className:"ml-4",disabled:g,processing:g,children:"S'inscrire"})]})]})]})}export{J as default};
