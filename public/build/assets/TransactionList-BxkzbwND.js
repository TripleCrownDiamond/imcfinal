import{q as T,W as E,r as i,j as e,Y as k,a as j}from"./app-CU81j7nS.js";import{A as D,m as M}from"./AuthenticatedLayout-dRBKfQCh.js";import{n as a}from"./index-CRzonMBn.js";import{f as P,a as $}from"./fr-Dz8sqj0j.js";import{P as c}from"./PrimaryButton-B91Wo0_j.js";import{d as y}from"./index-W5QgHgs8.js";import"./ApplicationLogo-CKQckDiy.js";import"./transition-CyRQxhFf.js";import"./SecondaryButton-BoGYldyN.js";import"./en-US-DckgOUrT.js";function H({transactions:x,isAdmin:o,auth:A,user:u}){const{flash:r}=T().props,{post:w}=E(),b=M.name;document.head.querySelector('meta[name="csrf-token"]').content;const[p,v]=i.useState(x.data),[d,N]=i.useState(1),[l,h]=i.useState(!1);i.useEffect(()=>{r!=null&&r.success&&a.success(r.success),r!=null&&r.error&&a.error(r.error)},[r]);const _=s=>s==="confirmed"&&"bg-green-200 text-green-800"||s==="pending"&&"bg-yellow-200 text-yellow-800"||s==="canceled"&&"bg-red-200 text-red-800"||"bg-gray-200 text-gray-800",C=s=>s.type==="transfer"?s.user_id===u.id?"Transfert sortant":"Transfert entrant":s.type==="deposit"?"Dépôt":"Retrait",f=(s,t,n)=>{s.preventDefault();const S=n==="confirm"?"Êtes-vous sûr de vouloir confirmer cette transaction ?":"Êtes-vous sûr de vouloir annuler cette transaction ?";window.confirm(S)&&w(`/transactions/${t}/${n}`,{onSuccess:()=>{const m=n==="confirm"?"Transaction confirmée avec succès !":"Transaction annulée avec succès !";a.success(m),y.Inertia.visit(window.location.href,{method:"get",preserveState:!0})},onError:m=>{a.error("Erreur lors de l'action !"),console.error(m)}})},g=s=>{h(!0),y.Inertia.get(`/transactions?page=${s}`,{},{onSuccess:t=>{const n=t.props.transactions;v(n.data),N(s)},onError:()=>{a.error("Erreur lors du chargement des transactions.")},preserveScroll:!0,onFinish:()=>h(!1)})};return e.jsxs(D,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Liste des Transactions"}),children:[e.jsx(k,{title:"Transactions"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center sm:items-start mb-4 gap-4",children:[e.jsx(c,{children:e.jsx(j,{href:"/transactions/create",children:"Faire une transaction"})}),o&&e.jsx(j,{href:"/deposit-methods",className:"text-blue-600 hover:underline text-sm sm:text-base font-medium",children:"Modifier les méthodes de paiement"})]}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:p.length===0?e.jsx("p",{className:"text-gray-500 text-center",children:"Aucune transaction trouvée."}):e.jsx("ul",{children:p.map(s=>e.jsxs("li",{className:"border-b border-gray-300 py-4 hover:bg-gray-100 transition duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#cd8b76]",children:C(s)}),e.jsxs("p",{className:"text-gray-700",children:["Montant:"," ",e.jsxs("strong",{className:"text-[#82b170]",children:[s.amount," ",b]})]}),s.type==="transfer"&&e.jsx("p",{className:"text-gray-500",children:s.user_id===u.id?`Destinataire: ${s.receiver_username}`:`Expéditeur: ${s.sender_username}`}),o&&s.type!=="transfer"&&e.jsxs("p",{className:"text-gray-500",children:["Initiateur:"," ",e.jsx("strong",{children:s.sender_username})]}),s.type==="deposit"&&e.jsxs("p",{className:"text-gray-500",children:["Méthode de dépot:"," ",e.jsx("strong",{children:s.deposit_method.name})]}),s.type==="withdraw"&&e.jsxs("p",{className:"text-gray-500",children:[e.jsxs("span",{children:["Méthode de retrait:"," ",e.jsxs("strong",{children:[" ",s.withdrawal_method.name]})]}),e.jsxs("span",{className:"flex items-center gap-2 mt-2",children:["Numéro/Wallet:"," ",e.jsx("span",{className:"truncate max-w-xs text-gray-800 cursor-pointer underline hover:text-blue-600",onClick:()=>{navigator.clipboard.writeText(s.transaction_wallet.account_or_wallet),a.success("Adresse copiée dans le presse-papiers !")},title:s.transaction_wallet.account_or_wallet,children:s.transaction_wallet.account_or_wallet})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[e.jsx("p",{className:`px-2 py-1 rounded-full text-xs font-semibold ${_(s.status)}`,children:s.status}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Ajouté"," ",P(new Date(s.created_at),{addSuffix:!0,locale:$})]})]})]}),o&&s.status==="pending"&&e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsx(c,{onClick:t=>f(t,s.id,"confirm"),children:"Confirmer"}),e.jsx(c,{onClick:t=>f(t,s.id,"cancel"),className:"bg-red-600 hover:bg-red-800",children:"Annuler"})]})]},s.id))})})}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsx(c,{onClick:()=>g(d-1),disabled:d<=1||l,children:l?"Chargement...":"Précédent"}),e.jsx(c,{onClick:()=>g(d+1),disabled:!x.next_page_url||l,children:l?"Chargement...":"Suivant"})]})]})})]})}export{H as default};
