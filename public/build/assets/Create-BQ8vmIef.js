import{q as S,r as i,W as D,j as e,Y as z,a as E}from"./app-CU81j7nS.js";import{A as F,m as b}from"./AuthenticatedLayout-dRBKfQCh.js";import{P as _}from"./PrimaryButton-B91Wo0_j.js";import{n as m}from"./index-CRzonMBn.js";import"./ApplicationLogo-CKQckDiy.js";import"./transition-CyRQxhFf.js";import"./SecondaryButton-BoGYldyN.js";function K({auth:U,depositMethods:h,withdrawalMethods:x}){S().props;const[c,v]=i.useState(null),[W,p]=i.useState(!1),[o,j]=i.useState(null),[l,f]=i.useState([]),{data:t,setData:d,post:y,errors:a,reset:w}=D({transactionType:"",amount:"",recipientUsername:"",depositMethod:"",withdrawalMethod:"",currency:"",selectedCurrency:"",walletAddress:""}),N=async()=>{p(!0);try{const s=await fetch("/currencies");if(s.ok){const r=await s.json(),n=[b,...r];f(n)}else console.error("Échec du chargement des devises")}catch(s){console.error("Erreur lors de la récupération des devises:",s)}finally{p(!1)}};i.useEffect(()=>{N()},[]);const C=s=>{if(s.preventDefault(),t.transactionType!=="transfer"&&!o){m.error("Veuillez sélectionner une devise.");return}const r={...t,currency:t.transactionType==="transfer"?null:o.id,withdrawalMethod:t.withdrawalMethod,walletAddress:t.walletAddress,amount:t.amount},n={deposit:"/transactions/deposit",withdraw:"/transactions/withdraw",transfer:"/transactions/transfer"}[t.transactionType]||"/transactions/transfer";y(n,{data:r,onSuccess:()=>{const u={deposit:"Votre dépôt est en attente de validation.",transfer:"Votre transfert est en attente de validation !",withdraw:"Votre demande de retrait a été soumise."};m.success(u[t.transactionType]||"Transaction réussie."),w()},onError:u=>{Object.values(u).forEach(A=>m.error(A))}})},M=(s,r)=>{r.preventDefault(),navigator.clipboard.writeText(s),m.success("Adresse copiée avec succès !")},k=s=>{const r=h.find(n=>n.id===parseInt(s.target.value));v(r||null),d("depositMethod",s.target.value)},T=s=>{const r=x.find(n=>n.id===parseInt(s.target.value));d("withdrawalMethod",r?r.id:"")},g=s=>{const r=l.find(n=>n.id===parseInt(s.target.value));j(r),d("currency",r?r.id:"")};return e.jsxs(F,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Faire une transaction"}),children:[e.jsx(z,{title:"Faire une transaction"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Type de transaction"}),e.jsxs("select",{value:t.transactionType,onChange:s=>d("transactionType",s.target.value),className:"mt-2 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Choisissez le type de transaction"}),e.jsx("option",{value:"transfer",children:"Transfert"}),e.jsx("option",{value:"deposit",children:"Dépôt"}),e.jsx("option",{value:"withdraw",children:"Retrait"})]}),a.transactionType&&e.jsx("div",{className:"text-red-500",children:a.transactionType})]}),t.transactionType==="transfer"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Nom d'utilisateur du destinataire"}),e.jsx("input",{type:"text",value:t.recipientUsername,onChange:s=>d("recipientUsername",s.target.value),className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Nom d'utilisateur du destinataire"}),a.recipientUsername&&e.jsx("div",{className:"text-red-500",children:a.recipientUsername})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-gray-700",children:["Montant en ",b.name]}),e.jsx("input",{type:"number",value:t.amount,onChange:s=>d("amount",s.target.value),className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Montant"}),a.amount&&e.jsx("div",{className:"text-red-500",children:a.amount})]})]}),t.transactionType==="deposit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Méthode de dépôt"}),e.jsxs("select",{value:t.depositMethod,onChange:k,className:"mt-2 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Choisissez une méthode de dépôt"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),a.depositMethod&&e.jsx("div",{className:"text-red-500",children:a.depositMethod})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Devise :"}),e.jsxs("select",{id:"currency",value:o?o.id:"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[e.jsx("option",{value:"",children:"Sélectionnez une devise"}),l.length===0?e.jsx("option",{value:"",children:"Aucune devise disponible"}):l.map(s=>e.jsxs("option",{value:s.id,children:[s.name," ","(",s.code,")"]},s.id))]}),a.currency&&e.jsx("div",{className:"text-red-500 mt-2",children:a.currency})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Montant"}),e.jsx("input",{type:"number",value:t.amount,onChange:s=>d("amount",s.target.value),className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Montant à déposer"}),a.amount&&e.jsx("div",{className:"text-red-500",children:a.amount})]}),c&&e.jsxs("div",{className:"mt-6 p-4 border rounded-md bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-800",children:"Détails de la méthode de dépôt"}),e.jsx("p",{className:"mt-2 text-gray-600",children:c.description}),c.fields&&e.jsx("ul",{className:"mt-4 space-y-2",children:c.fields.map((s,r)=>e.jsxs("li",{className:"text-gray-600 flex items-center",children:[e.jsxs("span",{className:"font-medium",children:[s.field_name,":"]})," ",s.field_name==="Wallet Adresse"?e.jsxs("button",{type:"button",onClick:n=>M(s.field_value,n),className:"ml-2 text-indigo-600 underline hover:text-indigo-800",children:[s.field_value," ","(Copier)"]}):e.jsx("span",{className:"ml-2",children:s.field_value})]},r))})]})]}),t.transactionType==="withdraw"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Méthode de retrait"}),e.jsxs("select",{value:t.withdrawalMethod,onChange:T,className:"mt-2 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Choisissez une méthode de retrait"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),a.withdrawalMethod&&e.jsx("div",{className:"text-red-500",children:a.withdrawalMethod})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Devise :"}),e.jsxs("select",{id:"currency",value:o?o.id:"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[e.jsx("option",{value:"",children:"Sélectionnez une devise"}),l.length===0?e.jsx("option",{value:"",children:"Aucune devise disponible"}):l.map(s=>e.jsxs("option",{value:s.id,children:[s.name," ","(",s.code,")"]},s.id))]}),a.currency&&e.jsx("div",{className:"text-red-500 mt-2",children:a.currency})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Montant"}),e.jsx("input",{type:"number",value:t.amount,onChange:s=>d("amount",s.target.value),className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Montant à retirer"}),a.amount&&e.jsx("div",{className:"text-red-500",children:a.amount})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:t.withdrawalMethod==="1"?"Adresse du Wallet":"Numéro de Compte"}),e.jsx("input",{type:"text",value:t.walletAddress,onChange:s=>d("walletAddress",s.target.value),className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:t.withdrawalMethod==="1"?"Entrez l'adresse du wallet":"Entrez le numéro de compte"}),a.walletAddress&&e.jsx("div",{className:"text-red-500",children:a.walletAddress})]})]}),e.jsxs("p",{className:"mt-6 text-center font-semibold text-sm",children:["Contactez le support via"," ",e.jsx("a",{href:"https://t.me/IMARKET_Consulting",target:"_blank",rel:"noopener noreferrer",className:"text-[#88ae75] underline hover:text-[#cd8b76]",children:"Telegram"})," ","pour toute assistance ou confirmer une transaction."]}),e.jsxs("div",{className:"flex justify-between align-middle space-x-4",children:[e.jsx(E,{href:"/transactions",className:"text-sm underline text-gray-600 hover:text-gray-900",children:"Annuler"}),e.jsx(_,{type:"submit",children:"Soumettre"})]})]})})})})})]})}export{K as default};
